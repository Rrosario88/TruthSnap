# Dockerfile
FROM node:20-alpine

WORKDIR /app

# Install create-next-app globally
RUN npm install -g create-next-app

# Create a shell script to setup the project
RUN echo '#!/bin/sh\n\
if [ ! -f "package.json" ]; then\n\
    echo "Creating new Next.js project..."\n\
    yes | create-next-app@latest . \\\n\
        --typescript \\\n\
        --tailwind \\\n\
        --eslint \\\n\
        --app \\\n\
        --src-dir \\\n\
        --no-turbo \\\n\
        --import-alias "@/*"\n\
fi\n\
\n\
echo "Installing dependencies..."\n\
npm install\n\
\n\
echo "Starting development server..."\n\
npm run dev\n' > /app/init.sh

RUN chmod +x /app/init.sh

# Expose port 3000
EXPOSE 3000

# Start command
CMD ["/app/init.sh"]